---
name: Trigger nightly images

on:
  schedule:
    # nightly packaging job usually finish around 14 UTC
    - cron:  '0 15 * * *'
jobs:
  source_build:
    name: Trigger devel image
    env:
      dockerTag: ${{ 'devel' }}
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Call devel webhook
      run: |
        curl -H "Content-Type: application/json" --data '{"docker_tag": "${{env.dockerTag}}"}'  -X POST ${{ secrets.DOCKER_ROS2_POST_PUSH_TRIGGER }}
  nightly_build:
    name: Trigger nightly image
    env:
      dockerTag: ${{ 'nightly' }}
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v1
    - name: Call nightly webhook
      run: |
        curl -H "Content-Type: application/json" --data '{"docker_tag": "${{env.dockerTag}}"}'  -X POST ${{ secrets.DOCKER_ROS2_POST_PUSH_TRIGGER }}
